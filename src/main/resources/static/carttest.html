<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="UTF-8" />
    <title>購物車測試</title>
  </head>
  <body>
    <form
      id="ecpay-form"
      action="https://ericpay4.zeabur.app/ecpay/checkout"
      method="POST"
    >
      <input type="hidden" name="amount" id="amount" />
      <input type="hidden" name="itemName" id="itemName" />
      <button type="submit">前往結帳</button>
    </form>

    <script>
      window.onload = function() {
        console.log("頁面 onload 完成");
      };
      // 假設你的購物車長這樣
      const cart = [
        { name: "蘋果", price: 100, qty: 1 },
        { name: "香蕉", price: 150, qty: 2 },
        { name: "橘子", price: 50, qty: 1 },
      ];

      // 1) 組成能被綠界換行的字串（用 # 分隔）
      const lines = cart.map((i) => `${i.name} ${i.price}元X${i.qty}`);
      // 2) 自行計算總金額（綠界不會替你算）
      const total = cart.reduce((sum, i) => sum + i.price * i.qty, 0);

      // 3) 填到 hidden 欄位
      document.getElementById("itemName").value = lines.join("#");//後端傳出購物車資訊內容
      document.getElementById("amount").value = String(total);//後端傳出金額




      //先登入才能結帳  (門神UI)
      // document.getElementById('ecpay-form').addEventListener('submit', function(e) {
      //   const token = localStorage.getItem('jwt_token');
      //   if (!token) {
      //     e.preventDefault();
      //     alert('請先登入才能結帳');
      //     window.location.href = 'index_test.html';
      //   }
      //   // 有token才會真的送出表單
      // });
    </script>
  </body>
</html>
